var shareDonDtwitter=(()=>{var o=Object.create,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,u=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,e=(e=>"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(e,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):e)(function(e){if("react"===e)return Spicetify.React;if("react-dom"===e)return Spicetify.ReactDOM;if("undefined"!=typeof require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),t=(e,t,n)=>{n=null!=e?o(u(e)):{};var i=!t&&e&&e.__esModule?n:l(n,"default",{value:e,enumerable:!0}),a=e,s=void 0,r=void 0;if(a&&"object"==typeof a||"function"==typeof a)for(let e of d(a))p.call(i,e)||e===s||l(i,e,{get:()=>a[e],enumerable:!(r=c(a,e))||r.enumerable});return i},r=(function(c,e,d){"use strict";var i,u,n,t,r,a,o;if(c.MutationObserver&&"undefined"!=typeof HTMLElement)i=0,n=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector,u={matchesSelector:function(e,t){return e instanceof HTMLElement&&n.call(e,t)},addMethod:function(e,t,n){var i=e[t];e[t]=function(){return n.length==arguments.length?n.apply(this,arguments):"function"==typeof i?i.apply(this,arguments):void 0}},callCallbacks:function(e,t){t&&t.options.onceOnly&&1==t.firedElems.length&&(e=[e[0]]);for(var n,i=0;n=e[i];i++)n&&n.callback&&n.callback.call(n.elem,n.elem);t&&t.options.onceOnly&&1==t.firedElems.length&&t.me.unbindEventWithSelectorAndCallback.call(t.target,t.selector,t.callback)},checkChildNodesRecursively:function(e,t,n,i){for(var a,s=0;a=e[s];s++)n(a,t,i)&&i.push({callback:t.callback,elem:a}),0<a.childNodes.length&&u.checkChildNodesRecursively(a.childNodes,t,n,i)},mergeArrays:function(e,t){var n,i={};for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i},toElementsArray:function(e){return e=void 0===e||"number"==typeof e.length&&e!==c?e:[e]}},s.prototype.addEvent=function(e,t,n,i){e={target:e,selector:t,options:n,callback:i,firedElems:[]};return this._beforeAdding&&this._beforeAdding(e),this._eventsBucket.push(e),e},s.prototype.removeEvent=function(e){for(var t,n=this._eventsBucket.length-1;t=this._eventsBucket[n];n--)e(t)&&(this._beforeRemoving&&this._beforeRemoving(t),t=this._eventsBucket.splice(n,1))&&t.length&&(t[0].callback=null)},s.prototype.beforeAdding=function(e){this._beforeAdding=e},s.prototype.beforeRemoving=function(e){this._beforeRemoving=e},t=s,r=function(a,s){var r=new t,o=this,l={fireOnAttributesModification:!1};return r.beforeAdding(function(t){var e,n=t.target,i=(n!==c.document&&n!==c||(n=document.getElementsByTagName("html")[0]),e=new MutationObserver(function(e){s.call(this,e,t)}),a(t.options));e.observe(n,i),t.observer=e,t.me=o}),r.beforeRemoving(function(e){e.observer.disconnect()}),this.bindEvent=function(e,t,n){t=u.mergeArrays(l,t);for(var i=u.toElementsArray(this),a=0;a<i.length;a++)r.addEvent(i[a],e,t,n)},this.unbindEvent=function(){var n=u.toElementsArray(this);r.removeEvent(function(e){for(var t=0;t<n.length;t++)if(this===d||e.target===n[t])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(n){var i=u.toElementsArray(this),a=n,e="function"==typeof n?function(e){for(var t=0;t<i.length;t++)if((this===d||e.target===i[t])&&e.callback===a)return!0;return!1}:function(e){for(var t=0;t<i.length;t++)if((this===d||e.target===i[t])&&e.selector===n)return!0;return!1};r.removeEvent(e)},this.unbindEventWithSelectorAndCallback=function(n,i){var a=u.toElementsArray(this);r.removeEvent(function(e){for(var t=0;t<a.length;t++)if((this===d||e.target===a[t])&&e.selector===n&&e.callback===i)return!0;return!1})},this},a=new function(){var l={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function s(e,t,n){return!(!u.matchesSelector(e,t.selector)||(e._id===d&&(e._id=i++),-1!=t.firedElems.indexOf(e._id))||(t.firedElems.push(e._id),0))}var c=(a=new r(function(e){var t={attributes:!1,childList:!0,subtree:!0};return e.fireOnAttributesModification&&(t.attributes=!0),t},function(e,a){e.forEach(function(e){var t=e.addedNodes,n=e.target,i=[];null!==t&&0<t.length?u.checkChildNodesRecursively(t,a,s,i):"attributes"===e.type&&s(n,a)&&i.push({callback:a.callback,elem:n}),u.callCallbacks(i,a)})})).bindEvent;return a.bindEvent=function(e,t,n){t=void 0===n?(n=t,l):u.mergeArrays(l,t);var i=u.toElementsArray(this);if(t.existing){for(var a=[],s=0;s<i.length;s++)for(var r=i[s].querySelectorAll(e),o=0;o<r.length;o++)a.push({callback:n,elem:r[o]});if(t.onceOnly&&a.length)return n.call(a[0].elem,a[0].elem);setTimeout(u.callCallbacks,1,a)}c.call(this,e,t,n)},a},o=new function(){var i={};function a(e,t){return u.matchesSelector(e,t.selector)}var s=(o=new r(function(){return{childList:!0,subtree:!0}},function(e,n){e.forEach(function(e){var e=e.removedNodes,t=[];null!==e&&0<e.length&&u.checkChildNodesRecursively(e,n,a,t),u.callCallbacks(t,n)})})).bindEvent;return o.bindEvent=function(e,t,n){t=void 0===n?(n=t,i):u.mergeArrays(i,t),s.call(this,e,t,n)},o},e&&p(e.fn),p(HTMLElement.prototype),p(NodeList.prototype),p(HTMLCollection.prototype),p(HTMLDocument.prototype),p(Window.prototype),l(a,e={},"unbindAllArrive"),l(o,e,"unbindAllLeave");function s(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null}function l(e,t,n){u.addMethod(t,n,e.unbindEvent),u.addMethod(t,n,e.unbindEventWithSelectorOrCallback),u.addMethod(t,n,e.unbindEventWithSelectorAndCallback)}function p(e){e.arrive=a.bindEvent,l(a,e,"unbindArrive"),e.leave=o.bindEvent,l(o,e,"unbindLeave")}}(window,"undefined"==typeof jQuery?null:jQuery,void 0),t(e("react"))),i=t(e("react-dom")),f={settingsContainer:"settings-module__settingsContainer___e9wxn_shareDonDtwitter",heading:"settings-module__heading___AnER-_shareDonDtwitter",description:"settings-module__description___dP4fR_shareDonDtwitter",inputWrapper:"settings-module__inputWrapper___LgOrw_shareDonDtwitter"},a=class{constructor(e,t,n={}){this.name=e,this.settingsId=t,this.initialSettingsFields=n,this.settingsFields=this.initialSettingsFields,this.setRerender=null,this.buttonClassnames=null,this.pushSettings=async()=>{for(Object.entries(this.settingsFields).forEach(([e,t])=>{"button"!==t.type&&void 0===this.getFieldValue(e)&&this.setFieldValue(e,t.defaultValue)});!Spicetify?.Platform?.History?.listen;)await new Promise(e=>setTimeout(e,100));this.stopHistoryListener&&this.stopHistoryListener(),this.stopHistoryListener=Spicetify.Platform.History.listen(e=>{"/preferences"===e.pathname&&this.render()}),"/preferences"===Spicetify.Platform.History.location.pathname&&await this.render()},this.rerender=()=>{this.setRerender&&this.setRerender(Math.random())},this.render=async()=>{for(;!document.getElementById("desktop.settings.selectLanguage");){if("/preferences"!==Spicetify.Platform.History.location.pathname)return;await new Promise(e=>setTimeout(e,100))}var e=document.querySelector(".main-view-container__scroll-node-child main div");if(!e)return console.error("[spcr-settings] settings container not found");this.buttonClassnames=Array.from(e.querySelectorAll(":scope > button")).at(-1)?.className??null;let t=Array.from(e.children).find(e=>e.id===this.settingsId);t?console.log(t):((t=document.createElement("div")).id=this.settingsId,t.className=f.settingsContainer,e.appendChild(t)),i.default.render(r.default.createElement(this.FieldsContainer,null),t)},this.addButton=(e,t,n,i,a)=>{this.settingsFields[e]={type:"button",description:t,value:n,events:{onClick:i,...a}}},this.addInput=(e,t,n,i,a)=>{this.settingsFields[e]={type:"input",description:t,defaultValue:n,events:{onChange:i,...a}}},this.addHidden=(e,t)=>{this.settingsFields[e]={type:"hidden",defaultValue:t}},this.addToggle=(e,t,n,i,a)=>{this.settingsFields[e]={type:"toggle",description:t,defaultValue:n,events:{onChange:i,...a}}},this.addDropDown=(e,t,n,i,a,s)=>{this.settingsFields[e]={type:"dropdown",description:t,defaultValue:n[i],options:n,events:{onSelect:a,...s}}},this.getFieldValue=e=>JSON.parse(Spicetify.LocalStorage.get(this.settingsId+"."+e)||"{}")?.value,this.setFieldValue=(e,t)=>{Spicetify.LocalStorage.set(this.settingsId+"."+e,JSON.stringify({value:t}))},this.FieldsContainer=()=>{var[e,t]=(0,r.useState)(0);return this.setRerender=t,r.default.createElement("div",{className:f.settingsContainer,key:e},r.default.createElement("h2",{className:["main-shelf-title main-type-cello",f.heading].join(" ")},this.name),Object.entries(this.settingsFields).map(([e,t])=>r.default.createElement(this.Field,{nameId:e,field:t})))},this.Field=n=>{var e=this.settingsId+"."+n.nameId;let t;if(t="button"===n.field.type?n.field.value:this.getFieldValue(n.nameId),"hidden"===n.field.type)return r.default.createElement(r.default.Fragment,null);const[i,a]=(0,r.useState)(t),s=e=>{void 0!==e&&(a(e),this.setFieldValue(n.nameId,e))};return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:"main-type-mesto",style:{color:"var(--spice-subtext)"}},r.default.createElement("label",{className:f.description,htmlFor:e},n.field.description||"")),r.default.createElement("span",{className:["x-settings-secondColumn",f.inputWrapper].join(" ")},"input"===n.field.type?r.default.createElement("input",{className:"main-dropDown-dropDown",id:e,dir:"ltr",value:i,type:"text",...n.field.events,onChange:e=>{s(e.currentTarget.value);var t=n.field.events?.onChange;t&&t(e)}}):"button"===n.field.type?r.default.createElement("span",{className:""},r.default.createElement("button",{id:e,className:this.buttonClassnames??"",...n.field.events,onClick:e=>{s();var t=n.field.events?.onClick;t&&t(e)},type:"button"},i)):"toggle"===n.field.type?r.default.createElement("label",{className:"x-toggle-wrapper x-settings-secondColumn"},r.default.createElement("input",{id:e,className:"x-toggle-input",type:"checkbox",checked:i,...n.field.events,onClick:e=>{s(e.currentTarget.checked);var t=n.field.events?.onClick;t&&t(e)}}),r.default.createElement("span",{className:"x-toggle-indicatorWrapper"},r.default.createElement("span",{className:"x-toggle-indicator"}))):"dropdown"===n.field.type?r.default.createElement("select",{className:"main-dropDown-dropDown",id:e,...n.field.events,onChange:e=>{s(n.field.options[e.currentTarget.selectedIndex]);var t=n.field.events?.onChange;t&&t(e)}},n.field.options.map((e,t)=>r.default.createElement("option",{selected:e===i,value:t+1},e))):r.default.createElement(r.default.Fragment,null)))}}},n={"app.share-on-twitter":"Share on Twitter","app.unknown":"Unknown","app.podcast":"Podcast","app.episode":"episode","app.playlist":"Playlist","message.not-playing":"Music is not currently playing","message.non-supported-type":"Non-supported type","message.settings-notification":"This setting will take effect after reboot","settings.title":"Share on Twitter settings","settings.tweet-button":"Show Tweet button in the control panel","settings.share-button":"Show share button in the context menu"},s={"app.share-on-twitter":"Twitterでシェア","app.unknown":"不明","app.podcast":"ポッドキャスト","app.episode":"エピソード","app.playlist":"プレイリスト","message.not-playing":"音楽は現在再生されていません","message.non-supported-type":"このタイプのシェアには対応していません","message.settings-notification":"この設定は再起動後に有効になります","settings.title":"「Twitterでシェア」に関する設定","settings.tweet-button":"コントロールパネルにツイートボタンを表示する","settings.share-button":"コンテキストメニューに「Twitterでシェア」を表示する"},h=new class{constructor(){this.lang="en",this.availableLangs={en:n,ja:s};var e=navigator.language;this.lang=this.availableLangs[e]?e:"en"}loc(e){var t=this.availableLangs[this.lang][e];return t||this.availableLangs.en[e]||"Failed to get localized text"}};async function m(e){var t=e[0],e=t.split(":")[1],n=t.split(":")[2];let i;switch(e){case Spicetify.URI.Type.TRACK:i=await y.track(n);break;case Spicetify.URI.Type.ALBUM:i=await y.album(n);break;case Spicetify.URI.Type.ARTIST:i=await y.artist(n);break;case Spicetify.URI.Type.SHOW:i=await y.show(n);break;case Spicetify.URI.Type.EPISODE:i=await y.episode(n);break;case Spicetify.URI.Type.PLAYLIST:case Spicetify.URI.Type.PLAYLIST_V2:i=await y.playlist(t);break;default:i=null}if(!i)return Spicetify.showNotification(h.loc("message.non-supported-type"));g(Object.assign(i,{uri:t}))}function g(e){var t=e.uri.split(":"),e=`${e.title||h.loc("app.unknown")}${e.artist?" - "+e.artist:""}
https://open.spotify.com/${t[1]}/`+t[2];window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(e)}&hashtags=Spotify`.replace("\n","%0D%0A"))}var y={track:async e=>{e=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/tracks/"+e);return{title:e.name,artist:e.artists[0].name}},album:async e=>{return{title:(await Spicetify.CosmosAsync.get(`wg://album/v1/album-app/album/${e}/desktop`)).name}},artist:async e=>{return{title:(await Spicetify.CosmosAsync.get(`wg://artist/v1/${e}/desktop?format=json`)).info.name}},show:async e=>{return{title:(await Spicetify.CosmosAsync.get(`sp://core-show/unstable/show/${e}?responseFormat=protobufJson`,{policy:{list:{index:!0}}})).header.showMetadata.name,artist:h.loc("app.podcast")}},episode:async e=>{e=await Spicetify.CosmosAsync.get("https://api.spotify.com/v1/episodes/"+e);return{title:e.name,artist:e.show.name+" "+h.loc("app.episode")}},playlist:async e=>{return{title:(await Spicetify.CosmosAsync.get(`sp://core-playlist/v1/playlist/${e}/metadata`,{policy:{picture:!0,name:!0}})).metadata.name,artist:h.loc("app.playlist")}}};function v(){Spicetify.showNotification(h.loc("message.settings-notification"))}(async()=>{(async function(){for(;!Spicetify;)await new Promise(e=>setTimeout(e,100));const n=new a(h.loc("settings.title"),"share-on-twitter");n.addToggle("enable-tweet-button",h.loc("settings.tweet-button"),!0,v),n.addToggle("enable-context-menu",h.loc("settings.share-button"),!0,v),await n.pushSettings(),n.getFieldValue("enable-context-menu")&&new Spicetify.ContextMenu.Item(h.loc("app.share-on-twitter"),m,void 0,"twitter").register(),document.arrive(".main-nowPlayingBar-right > *",{existing:!0,onceOnly:!0},e=>{var t;n.getFieldValue("enable-tweet-button")&&((t=document.createElement("div")).id="share-on-twitter",t.innerHTML=`<button class="control-button" style="padding: 8px;" aria-label="${h.loc("app.share-on-twitter")}" aria-describedby="share-on-twitter">
            <svg role="presentation" style="fill: currentColor" viewBox="0 0 16 16" height="16" width="16">
                <path d="M13.54 3.889q.984-.595 1.333-1.683-.905.54-1.929.738-.42-.452-.996-.706-.575-.254-1.218-.254-1.254 0-2.143.889-.889.889-.889 2.15 0 .318.08.691-1.857-.095-3.484-.932-1.627-.838-2.762-2.242-.413.714-.413 1.523 0 .778.361 1.445t.988 1.08q-.714-.009-1.373-.374v.04q0 1.087.69 1.92.691.834 1.739 1.048-.397.111-.794.111-.254 0-.571-.055.285.912 1.063 1.5.778.587 1.77.603-1.659 1.302-3.77 1.302-.365 0-.722-.048Q2.619 14 5.15 14q1.358 0 2.572-.361 1.215-.361 2.147-.988.933-.627 1.683-1.46.75-.834 1.234-1.798.484-.964.738-1.988t.254-2.032q0-.262-.008-.397.88-.635 1.508-1.563-.841.373-1.738.476z"></path>
            </svg>
        </button>`,t.addEventListener("click",()=>{var e,t=null==(t=Spicetify.Player.data)?void 0:t.track;if(!t)return Spicetify.showNotification(h.loc("message.not-playing"));g({uri:t.uri,title:null==(e=t.metadata)?void 0:e.title,artist:null==(e=t.metadata)?void 0:e.artist_name})}),e.prepend(t))})})()})()})();(async()=>{var e;document.getElementById("shareDonDtwitter")||((e=document.createElement("style")).id="shareDonDtwitter",e.textContent=String.raw`
  .settings-module__settingsContainer___e9wxn_shareDonDtwitter{display:contents}.settings-module__heading___AnER-_shareDonDtwitter{grid-column:1/-1;font-size:1.125rem;line-height:1.5rem;color:#fff;margin-top:24px}.settings-module__description___dP4fR_shareDonDtwitter{font-size:.875rem;line-height:1.25rem}.settings-module__inputWrapper___LgOrw_shareDonDtwitter{display:flex;justify-self:end}
      `.trim(),document.head.appendChild(e))})();